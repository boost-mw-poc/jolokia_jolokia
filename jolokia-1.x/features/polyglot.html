<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at 2023-07-12 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="jmx, rest, json, http, agent, jmx-rest-bridge, java, jmx4perl, jsr-160, jmx-rest"/>
    <title>Jolokia &#x2013; Polyglot</title>
    <style type="text/css" media="all">
      @import url("../css/reset.css");
      @import url("../css/text.css");
      @import url("../css/960_24_col.css");
      @import url("../css/maven-base.css");
      @import url("../css/prettify.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <script data-cfasync="false" type="text/javascript">
       var host = "jolokia.org";
       if ((host == window.location.host) && (window.location.protocol != "https:")) {
            window.location.protocol = "https";
       }
    </script>
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9534565-3']);
  _gaq.push(['_setDomainName', '.jolokia.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    <script type="text/javascript" src="../js/prettify/prettify.js"></script>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <link rel="icon" type="image/png" href="../images/favicon.png" />
      <meta name="author" content="Roland Huss" />
    <meta name="Date-Revision-yyyymmdd" content="20230712" />
    <meta http-equiv="Content-Language" content="en" />
     
  </head>
  <body class="composite" onload="prettyPrint()">
    <div class="container_24">

      <!-- Header -->
      <div class="grid_24 header">
        <div></div>
      </div>
      <div class="clear"></div>

      <!-- Top-Bar  -->
      <div class="grid_24 top_bar">
          <div class="top_left"></div>
      <div class="top_link">
        <a href="../index.html">Home</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../download.html">Download</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../features-nb.html">Features</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../documentation.html">Documentation</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../support.html">Support</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="https://ro14nd.de">Blog</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../about.html">About</a>
    </div>
    <div class="top_sep"></div>
        </div>
      <div class="clear"></div>

      <!-- Main-Box  -->
      <div class="grid_24 main_box">
        <!-- Main-Top -->
        <div class="grid_24 alpha main_top"></div>
        <div class="grid_24 alpha main_content">
          <!-- Navigation -->
          <div class="grid_5 alpha">
                  <div class="navibox">
          <div class="navihead">
             <h5>Jolokia</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="../features-nb.html" title="Features">Features</a>
            </li>
                  <li class="none">
                          <a href="../support.html" title="Support">Support</a>
            </li>
                  <li class="none">
                          <a href="../forum.html" title="Forum">Forum</a>
            </li>
                  <li class="none">
                          <a href="../irc.html" title="IRC">IRC</a>
            </li>
                  <li class="none">
                          <a href="../license.html" title="License">License</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../documentation.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../tutorial.html" title="Tutorial">Tutorial</a>
            </li>
                  <li class="none">
                          <a href="../reference/html/index.html" title="Reference Manual">Reference Manual</a>
            </li>
                  <li class="none">
                          <a href="../talks.html" title="Talks and Screencasts">Talks and Screencasts</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Agents</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../agent.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../agent/war.html" title="Web Archive (war)">Web Archive (war)</a>
            </li>
                  <li class="none">
                          <a href="../agent/osgi.html" title="Osgi">Osgi</a>
            </li>
                  <li class="none">
                          <a href="../agent/jvm.html" title="JVM">JVM</a>
            </li>
                  <li class="none">
                          <a href="../agent/mule.html" title="Mule">Mule</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Clients</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../client/java.html" title="Java">Java</a>
            </li>
                  <li class="none">
                          <a href="../client/javascript.html" title="Javascript">Javascript</a>
            </li>
                  <li class="none">
                          <a href="../client/perl.html" title="Perl">Perl</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Project Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
    </div>
      </div>
            </div>
          <!-- Main Box -->
          <div class="grid_18 omega">
            <div class="content_box grid_18 alpha">
              <div class="content_top_bg content_top grid_18 alpha"></div>
              <div class="content_content_bg content_content grid_18">
                <!-- ~ Copyright 2009-2013 Roland Huss
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~       http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License. -->
  
  
    <div class="section">
<h2><a name="Polyglot"></a>Polyglot</h2>
      
<div class="feature_icon_large">
        <img src="../images/features/polyglot_large.png" alt="Polyglot" />
      </div>
      
<p>
        The next examples demonstrate the usage of Jolokia with
        various different clients.  The samples check for memory and
        performs some action if the used heap memory exceeds a certain
        threshold. No error handling was included in order to focus on
        the Jolokia logic.
      </p>
      
<div class="section">
<h3><a name="Bash"></a>Bash</h3>
        
<p>
          Jolokia can be contacted withot any client library directly
          from a Bash script. This example checks, that the Memory used doesn't
          exceeds 90% of the available memory, and if so, restarts the
          Tomcat server (without any error handling, though):
        </p>
        
<div>
<pre class="prettyprint">
#!/bin/bash
base_url=&quot;http://localhost:8080/jolokia&quot;
memory_url=&quot;${base_url}/read/java.lang:type=Memory/HeapMemoryUsage&quot;
used=`wget -q -O - &quot;${memory_url}/used&quot; | sed 's/^.*&quot;value&quot;:\([0-9]*\).*$/\1/'`
max=`wget -q -O - &quot;${memory_url}/max&quot; | sed 's/^.*&quot;value&quot;:\([0-9]*\).*$/\1/'`
usage=$((${used}*100/${max}))
if [ $usage -gt 90 ]; then 
  /etc/init.d/tomcat restart
  sleep 120
fi</pre></div>
      </div>
      
<div class="section">
<h3><a name="Perl"></a>Perl</h3>
        
<p>
          Using the <a class="externalLink" href="http://www.jmx4perl.org">jmx4perl</a>
          client library, this can be done even simpler in Perl (and in
          this case with a single HTTP request):
        </p>
        
<div>
<pre class="prettyprint">
#!/usr/bin/perl
use JMX::Jmx4Perl;
use strict;
my $jmx = new JMX::Jmx4Perl(url =&gt; &quot;http://localhost:8080/jolokia&quot;);
my $memory = $jmx-&gt;get_attribute(&quot;java.lang:type=Memory&quot;,&quot;HeapMemoryUsage&quot;);
if ($memory-&gt;{&quot;used&quot;} / $memory-&gt;{&quot;max&quot;} &gt; 0.9) {
    system(&quot;/etc/init.d/tomcat restart&quot;);
    sleep(120);
}</pre></div>
      </div>
      
<div class="section">
<h3><a name="Javascript"></a>Javascript</h3>
        
<p>
          The JSON based Jolokia protocol fits perfectly in the
          Javascript world. Jolokia provides a <a href="../client/javascript.html">Javascript client
          library</a> which makes it a piece of cake to access JMX
          information directly from within the browser. A variant of
          the memory example above looks in Javascript like this:
        </p>
        
<div>
<pre class="prettyprint">
var j4p = new Jolokia(&quot;/jolokia&quot;);
j4p.request(
 {
   type: &quot;read&quot;,
   mbean: &quot;java.lang:type=Memory&quot;,
   attribute: &quot;HeapMemoryUsage&quot;
 },{
   success: function(resp) {
      if (resp.value.used / resp.value.max &gt; 0.9) {
         alert(&quot;Memory exceeds 90% threshold&quot;);
      }
   }
 });</pre></div>
      </div>
      
<div class="section">
<h3><a name="Java"></a>Java</h3>
        
<p>
          The Jolokia agents can be accessed from Java as well. The
          biggest different to JSR-160 client interfaces is, that
          Jolokia has a typeless approach. The disadvantage is of
          course, that the type of the exposed
          attribute or operation return value has to be known, but the
          big advantage is, that no Java type information for custom
          types (== custom Java classes) is required on the client
          side. 
        </p>
        
<p>
          The example above implemented in Java looks like:
        </p>
        
<div>
<pre class="prettyprint">
import org.jolokia.client.*;
import org.jolokia.client.request.*;
import java.util.Map;

public class JolokiaSample {
    
    public static void main(String[] args) throws Exception {
        J4pClient j4pClient = new J4pClient(&quot;http://localhost:8080/jolokia&quot;);
        J4pReadRequest req = new J4pReadRequest(&quot;java.lang:type=Memory&quot;,
                                                &quot;HeapMemoryUsage&quot;);
        J4pReadResponse resp = j4pClient.execute(req);
        Map&lt;String,String&gt; vals = resp.getValue();
        int used = Integer.parseInt(vals.get(&quot;used&quot;));
        int max = Integer.parseInt(vals.get(&quot;max&quot;));
        int usage = (int) (used * 100 / max);
        if (usage &gt; 1) {
            System.out.println(&quot;Memory usage exceeds 90% (used: &quot; + used + 
                               &quot; / max: &quot; + max + &quot; = &quot; + usage + &quot;%)&quot;);
        }
    }
}</pre></div>
      </div>
      
<div class="section">
<h3><a name="Roadmap"></a>Roadmap</h3>
        
<p>
          In fact, serving non-java environments is one of the most
          outstanding strengths of Jolokia. The focus for the future
          evolution of Jolokia is to provide more client
          libraries. Top on the list are Groovy and Scala. If you like
          to add a client library in your favourite language, go
          ahead, we would be happy to include it. Currently, the
          tendency is to keep JVM based languages (+ Javascript) under
          the Jolokia umbrella, but support for others (like <a class="externalLink" href="http://www.jmx4perl.org">jmx4perl</a>) hosted
          elsewhere is in our focus as well. But well, let's see ;-).
        </p>
      </div>
      
<div class="section">
<h3><a name="Next"></a>Next</h3>
        
<ul>
          
<li>
            Read an introduction and <a href="overview.html">overview</a> for Jolokia.
          </li>
          
<li>
            See why Jolokia plays nicely with your <a href="firewall.html">firewall</a>.
          </li>
          
<li>
            Go Back to the <a href="../features-nb.html">Features Overview</a>.
          </li>
        </ul>
      </div>
    </div>
      

              </div>
              <div class="content_bottom_bg content_bottom grid_18 omega"></div>
            </div>
          </div>
          <div class="grid_24 alpha">
            <div class="copyright_footer">Copyright &#169;                   2023 Roland Hu&szlig;. 
          All Rights Reserved.      
                
                 <span id="publishDate">Last Published: 2023-07-12</span>
              &nbsp;| <span id="projectVersion">Version: 1.7.3-SNAPSHOT</span>
            </div>
          </div>
          <div class="clear"></div>
        </div>
        <!-- Main Bottom -->
        <div class="grid_24 alpha main_bottom"></div>        
      </div>
    </div>
  </body>
</html>
  
