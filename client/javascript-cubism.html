<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at 2023-07-12 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="jmx, rest, json, http, agent, jmx-rest-bridge, java, jmx4perl, jsr-160, jmx-rest"/>
    <title>Jolokia &#x2013; Jolokia Cubism Demo</title>
    <style type="text/css" media="all">
      @import url("../css/reset.css");
      @import url("../css/text.css");
      @import url("../css/960_24_col.css");
      @import url("../css/maven-base.css");
      @import url("../css/prettify.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <script data-cfasync="false" type="text/javascript">
       var host = "jolokia.org";
       if ((host == window.location.host) && (window.location.protocol != "https:")) {
            window.location.protocol = "https";
       }
    </script>
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9534565-3']);
  _gaq.push(['_setDomainName', '.jolokia.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    <script type="text/javascript" src="../js/prettify/prettify.js"></script>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <link rel="icon" type="image/png" href="../images/favicon.png" />
      <meta name="author" content="Roland Huss" />
    <meta name="Date-Revision-yyyymmdd" content="20230712" />
    <meta http-equiv="Content-Language" content="en" />
     <script type="text/javascript" src="../js/d3.v2.min.js"></script><script type="text/javascript" src="../js/jquery-1.7.2-min.js"></script><script type="text/javascript" src="../js/jolokia.js"></script><script type="text/javascript" src="../js/cubism.v1.min.js"></script><script type="text/javascript" src="../js/jolokia-cubism.js"></script><script type="text/javascript" src="../js/javascript-cubism.js"></script><link rel="stylesheet" type="text/css" href="../css/style.css" />
  </head>
  <body class="composite" onload="prettyPrint()">
    <div class="container_24">

      <!-- Header -->
      <div class="grid_24 header">
        <div></div>
      </div>
      <div class="clear"></div>

      <!-- Top-Bar  -->
      <div class="grid_24 top_bar">
          <div class="top_left"></div>
      <div class="top_link">
        <a href="../index.html">Home</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../download.html">Download</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../features-nb.html">Features</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../documentation.html">Documentation</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../support.html">Support</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="https://ro14nd.de">Blog</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="../about.html">About</a>
    </div>
    <div class="top_sep"></div>
        </div>
      <div class="clear"></div>

      <!-- Main-Box  -->
      <div class="grid_24 main_box">
        <!-- Main-Top -->
        <div class="grid_24 alpha main_top"></div>
        <div class="grid_24 alpha main_content">
          <!-- Navigation -->
          <div class="grid_5 alpha">
                  <div class="navibox">
          <div class="navihead">
             <h5>Jolokia</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="../features-nb.html" title="Features">Features</a>
            </li>
                  <li class="none">
                          <a href="../support.html" title="Support">Support</a>
            </li>
                  <li class="none">
                          <a href="../forum.html" title="Forum">Forum</a>
            </li>
                  <li class="none">
                          <a href="../irc.html" title="IRC">IRC</a>
            </li>
                  <li class="none">
                          <a href="../license.html" title="License">License</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../documentation.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../tutorial.html" title="Tutorial">Tutorial</a>
            </li>
                  <li class="none">
                          <a href="../reference/html/index.html" title="Reference Manual">Reference Manual</a>
            </li>
                  <li class="none">
                          <a href="../talks.html" title="Talks and Screencasts">Talks and Screencasts</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Agents</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../agent.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../agent/war.html" title="Web Archive (war)">Web Archive (war)</a>
            </li>
                  <li class="none">
                          <a href="../agent/osgi.html" title="Osgi">Osgi</a>
            </li>
                  <li class="none">
                          <a href="../agent/jvm.html" title="JVM">JVM</a>
            </li>
                  <li class="none">
                          <a href="../agent/mule.html" title="Mule">Mule</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Clients</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="../client/java.html" title="Java">Java</a>
            </li>
                  <li class="none">
                          <a href="../client/javascript.html" title="Javascript">Javascript</a>
            </li>
                  <li class="none">
                          <a href="../client/perl.html" title="Perl">Perl</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Project Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
    </div>
      </div>
            </div>
          <!-- Main Box -->
          <div class="grid_18 omega">
            <div class="content_box grid_18 alpha">
              <div class="content_top_bg content_top grid_18 alpha"></div>
              <div class="content_content_bg content_content grid_18">
                <!-- ~ Copyright 2009-2013 Roland Huss
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~       http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License. -->
  
  
    
<div class="section">
<h2><a name="Jolokia-Cubism_Integration"></a>Jolokia-Cubism Integration</h2>
      
<p>
        <a class="externalLink" href="http://square.github.com/cubism/">Cubism</a> is a
        fine Javascript library for plotting timeseries data based on
        <a class="externalLink" href="http://d3js.org/">d3.js</a>. It provides support for
        various backend sources like <a class="externalLink" href="http://graphite.wikidot.com/">Graphite</a> or <a class="externalLink" href="http://square.github.com/cube/">Cube</a> and also for
        Jolokia. It is easy to use and provides innovative chart types
        like a <a class="externalLink" href="http://vis.berkeley.edu/papers/horizon/">horizon</a>
        chart. The Jolokia integration polls the Jolokia agent
        periodically and remembers the values locally. It uses the <a href="../reference/html/clients.html#js-poller">scheduling
        facility</a> of the Jolokia Javascript library by sending a
        single bulk request for fetching the data for all charts and is
        hence very efficient.
      </p>
      
<p>
        The following sections show some simple real time demos of
        this integration. After that, some concepts are explained. The
        full Javascript source can be downloaded <a href="../js/javascript-cubism.js">here</a>.
      </p>
      
<div class="section">
<h3><a name="HeapMemory"></a>HeapMemory</h3>
        
<p>
          The following demo directly queries Jolokia's <a class="externalLink" href="http://labs.consol.de/jenkins">CI</a> which
          is a plain Tomcat 7. The memory charts show the heap memory
          usage as a fraction of the maximum available heap. Note that
          different colors indicate different value ranges in this horizon
          chart. The activity of the two garbage collectors for
          the young and old generation are shown below. Feel free to
          trigger a garbage collection on your own by pressing the
          button and look how the chart is changing.
        </p>
        
<div id="memory"></div>
        <button style="margin-top: 10px; margin-left: 25px;" onclick="gc()">Trigger Garbage Collection</button>
      </div>
      
<div class="section">
<h3><a name="Requests_per_10_seconds"></a>Requests (per 10 seconds)</h3>
        
<p>
          The second demo visualizes the number of requests served by
          this Tomcat instance. The requests are grouped by 10s, so
          the values are the number of requests received in the last
          10 seconds. The green charts show the requests for the <a class="externalLink" href="http://jolokia.org/jolokia">Jolokia agent</a> and the <a class="externalLink" href="http://labs.consol.de/jenkins">Jenkins  CI server</a>. Since this demo queries the Jolokia
          agent every second, the first chart should show up at least
          10 request per 10 seconds. Finally the number of requests
          served by all deployed servlets is drawn in blue. 
        </p>
        
<div id="request">
        </div>
      </div>
      
<div class="section">
<h3><a name="Examples"></a>Examples</h3>
        
<p>
          Plotting the result of a single Jolokia request is simple
          and follows the general pattern used by Cubism. You first
          create a Jolokia source from the Cubism context and create
          metrics from this source. When a metric is created, it
          registers one or more Jolokia request for the <a href="../reference/html/clients.html#js-poller">Jolokia scheduler</a>
        </p>
        
<div>
<pre class="prettyprint lang-javascript">  // Create a top-level Cubism Context
  var context = cubism.context();
  
  // Create a source for Jolokia metrics pointing to the agent 
  // at 'http://jolokia.org/jolokia'
  var jolokia = context.jolokia(&quot;http://jolokia.org/jolokia&quot;);

  // Create a metric for the absolute Heap memory usage
  var memoryAbs = jolokia.metric({
                      type: 'read', 
                      mbean: 'java.lang:type=Memory',
                      attribute: 'HeapMemoryUsage',
                      path: 'used'
                  },&quot;HeapMemory Usage&quot;);
 
   // Use d3 to attach the metrics with a specific graph type 
   // ('horizon' in this case) to the document
   d3.select(&quot;#charts&quot;).call(function(div) {
       div.append(&quot;div&quot;)
           .data([memoryAbs])
           .call(context.horizon())
   });</pre></div>
   
<p>
     The following example present an advanced concept if more
     flexibility is required. When the first argument to
     <tt>jolokia.metric()</tt> is a function, this function is
     feed periodically with Jolokia response objects resulting from the
     requests object given as second argument. The final
     argument can be an options object, which in this case indicates
     the label of the chart and the type to be a delta chart,
     measuring only the increase rate for ten seconds. 
   </p>
   
<p>
     This sample also shows how to use wildcard patterns in a read
     request to fetch multiple values at once in a generic
     fashion. Wildcard reading is explained in detail in the <a href="../reference/html/protocol.html#read">reference manual</a>.
   </p>
   
<div>
<pre class="prettyprint lang-javascript">  var allRequestsMetric = jolokia.metric(
    function (resp) {
        var attrs = resp.value;
        var sum = 0;
        for (var key in attrs) {
            sum += attrs[key].requestCount;
        }
        return sum;
    },
    { 
       type: &quot;read&quot;, 
       mbean: &quot;Catalina:j2eeType=Servlet,*&quot;,
       attribute: &quot;requestCount&quot;
    }, 
    {
       name: &quot;All Requests&quot;, 
       delta: 10 * 1000
    });</pre></div>
      </div>
    </div>
  

              </div>
              <div class="content_bottom_bg content_bottom grid_18 omega"></div>
            </div>
          </div>
          <div class="grid_24 alpha">
            <div class="copyright_footer">Copyright &#169;                   2023 Roland Hu&szlig;. 
          All Rights Reserved.      
                
                 <span id="publishDate">Last Published: 2023-07-12</span>
              &nbsp;| <span id="projectVersion">Version: 1.7.3-SNAPSHOT</span>
            </div>
          </div>
          <div class="clear"></div>
        </div>
        <!-- Main Bottom -->
        <div class="grid_24 alpha main_bottom"></div>        
      </div>
    </div>
  </body>
</html>
  
